let t=Promise,k=P=>{let o=0,n=0,r,l,u,s,d,a=()=>{o--,--n?m():s=u?.()},m=()=>{if(r&&o<P){o++;let i=r;r=r.e,i.p().then(e=>(i.i(e),a()),e=>(i.r(e),a()))}};return d={add(i){let e={p:i},T=new t((v,c)=>{e.i=v,e.r=c});return r?l=l.e=e:l=r=e,n++,m(),T},done:()=>n?s||(s=new t(i=>u=i)):t.resolve(),clear(){r=l=null,n=o},active:()=>o,size:()=>n,all:i=>t.all(i.map(e=>d.add(typeof e=="function"?e:()=>e)))}};export{k as newQueue};
