let l=Promise,f=m=>{let o=0,n=0,i,t,s,d,u=()=>{o--,--n?a():d=s?.()},a=()=>{if(i&&o<m){o++;let r=i;i=i.e,r.p().then(e=>(r.i(e),u()),e=>(r.r(e),u()))}};return{add(r){let e={p:r},v=new l((P,T)=>{e.i=P,e.r=T});return i?t=t.e=e:t=i=e,n++,a(),v},done:()=>n?d||(d=new l(r=>s=r)):l.resolve(),clear(){i=t=null,n=o},active:()=>o,size:()=>n}};export{f as newQueue};
